Bootstrap: docker
From: ubuntu:22.04

%files
    /home/jtian/src/516-singularity/cmake-3.25.1-linux-x86_64.tar.gz /root

%environment
    export SINGULARITY_MPICH_DIR=/usr
    export PATH=/root/cmake-3.25.1-linux-x86_64/bin:$PATH

%post
    apt-get -y update
    DEBIAN_FRONTEND=noninteractive apt-get -y install build-essential git wget
    DEBIAN_FRONTEND=noninteractive apt-get -y install g++-9
    DEBIAN_FRONTEND=noninteractive update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-9 9
    DEBIAN_FRONTEND=noninteractive update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-9 9
    DEBIAN_FRONTEND=noninteractive apt-get -y install nvidia-cuda-toolkit
    cd /root

%runscript
